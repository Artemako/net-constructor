# Настройка окружения

## Требования

- **Python 3.8.10**.
- ОС: Windows 10/11 (приложение ориентировано на Windows).

## Шаги

1. Клонируйте репозиторий и перейдите в корень проекта.

2. Создайте виртуальное окружение и активируйте его:

   ```powershell
   python -m venv .venv
   .venv\Scripts\Activate.ps1
   ```

   В cmd:

   ```cmd
   python -m venv .venv
   .venv\Scripts\activate.bat
   ```

3. Установите зависимости приложения:

   ```bash
   pip install -r requirements.txt
   ```

   **Состав зависимостей (requirements.txt):**

   | Пакет | Назначение |
   |-------|------------|
   | **PySide6**, **PySide6-Addons**, **PySide6-Essentials**, **shiboken6** | GUI и Qt. |
   | **nuitka** | Сборка exe (нужна только для сборки, не для запуска из исходников). |
   | **ordered-set** | Упорядоченные множества (используется в коде). |
   | **zstandard** | Сжатие (например, лицензия/данные). |

   Для скрипта `build/build_icon.py` дополнительно требуется **Pillow** (в requirements.txt не входит): `pip install Pillow`.

4. **Запуск из исходников:**

   - Демо: `python main.pyw --demo`
   - Полная версия: `python main.pyw --full`

   Если не указать `--demo`/`--full`, режим берётся из переменной окружения `NET_CONSTRUCTOR_MODE` (значения `demo` или `full`). При отсутствии сгенерированного `package/modules/_build_config.py` и переменной окружения по умолчанию используется режим `demo`.

5. **Опционально:** открыть файл проекта при старте:

   ```bash
   python main.pyw --demo путь/к/файлу.nce
   ```

6. **Редактирование UI главного окна**: исходник формы главного окна — `package/ui/mainwindow.ui`. После изменений в Qt Designer регенерируйте Python-модуль из корня проекта:

   ```bash
   pyside6-uic package/ui/mainwindow.ui -o package/ui/mainwindow_ui.py
   ```

   Ручные правки в `mainwindow_ui.py` по возможности не делайте; логика и обработчики — в `package/components/mainwindow.py`.

7. **Ресурсы Qt:** после изменения `resources.qrc` или добавления файлов в `resources/` нужно перегенерировать `resources_rc.py`.

   Из корня проекта:

   ```bash
   pyside6-rcc resources.qrc -o resources_rc.py
   ```

   Подробнее — раздел «Ресурсы и оформление» в [Архитектура](architecture.md).

Каталог `configs/` должен находиться рядом с запускаемым скриптом (в корне проекта при разработке). Исходник ресурсов — `resources.qrc`, регенерация — см. пункт 7 выше.

Ресурсы (иконки, шрифты) подключаются через `resources_rc.py`.

## Режимы demo и full

Приложение может работать в двух режимах: **demo** (демонстрационный) и **full** (полная версия).

- **Как задаётся режим:** при запуске из исходников — аргументами `--demo` или `--full`; при их отсутствии — переменной окружения `NET_CONSTRUCTOR_MODE` (значения `demo` или `full`). При сборке exe режим зашит в исполняемый файл; перед сборкой нужно выполнить `python build/build_variant.py --demo` или `--full`, чтобы сгенерировался `package/modules/_build_config.py`, от которого зависит режим в exe.
- **Чем отличаются режимы:** в режиме **demo** отключены действия «Новый», «Открыть», «Сохранить», «Сохранить как», «Экспорт в изображение»; проект можно только просматривать и редактировать в памяти без сохранения в файл. В режиме **full** доступны сохранение и открытие файлов проекта (`.nce`), экспорт в изображение.
- **Проверка режима в коде:** функция `is_demo_mode()` и `is_full_mode()` в `package.modules.license`; лицензионная проверка для exe выполняется в модуле `license`.

## Документация

Исходники документации — Markdown-файлы в каталоге `docs/`; навигация и тема задаются в `mkdocs.yml` в корне проекта.

Для предпросмотра: `mkdocs serve`. Для статической сборки в каталог `site/`: `mkdocs build`. Подробнее — раздел «Сборка документации» на [главной странице](index.md).

Установка зависимостей для документации:

```bash
pip install -r requirements-docs.txt
```
